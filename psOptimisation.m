%%%% PS Optimisation %%%%
nvars = 18;
lb = [6378 0 0 0 0 0 ...
      6378 0 0 0 0 0 ...
      6378 0 0 0 0 0];
ub = [42000 1.0 90 360 360 360 ...
      42000 1.0 90 360 360 360 ...
      42000 1.0 90 360 360 360];
  
options = optimoptions('particleswarm', 'UseParallel', 1, 'SwarmSize', 20, ...
                       'PlotFcn', {@pswplotbestf});

fun = @(x)ObjFunc(x);
[x, fval, exitflag, output] = particleswarm(fun, nvars, lb, ub, options);
